#!/bin/sh

# Testing build

######################################################################
# Script version is yymmdd-HHMMSS in UTC, date -u +%y%m%d-%H%M%S
######################################################################
SCRIPTVERSION=150928-055327

if [ "x" == "x${REPOSRC}" ]; then
    REPOSRC=https://github.com/
fi

if [ ! -d ${HOME}/gitlabports ]; then
    git clone ${REPOSRC}johnko/freebsd-ports-test.git -b gitlab-7.14.1 ${HOME}/gitlabports
fi

rsync -virthP --exclude .git  ${HOME}/gitlabports/  /usr/ports/

pkg install -y \
ruby libyaml \
ruby21-gems \
redis \
swig13 \
sqlite3 \
node python2 \
rubygem-multi_json rubygem-json_pure \
libxslt \
asciidoc python2 \
xmlto bash docbook-xsl xmlcatmgr docbook sdocbook-xml docbook-sgml iso8879 docbook-xml xmlcharent libpaper libxslt getopt \
scons m4 \
rubygem-wikicloth rubygem-builder rubygem-htmlentities rubygem-nokogiri rubygem-expression_parser rubygem-twitter-text rubygem-unf rubygem-unf_ext \
rubygem-warden rubygem-rack16 \
rubygem-virtus rubygem-equalizer rubygem-coercible rubygem-descendants_tracker rubygem-thread_safe rubygem-axiom-types rubygem-ice_nine \
rubygem-version_sorter \
rubygem-uuid rubygem-macaddr rubygem-systemu \
rubygem-unicorn-worker-killer rubygem-unicorn rubygem-raindrops rubygem-kgio rubygem-get_process_mem \
rubygem-underscore-rails \
rubygem-uglifier rubygem-json rubygem-execjs node \
rubygem-tzinfo rubygem-thread_safe1 rubygem-atomic \
rubygem-twitter-stream rubygem-http_parser.rb rubygem-simple_oauth rubygem-eventmachine \
rubygem-turbolinks-rails41 rubygem-coffee-rails41 rubygem-railties41 rubygem-actionpack41 rubygem-rack-test rubygem-actionview41 rubygem-builder32 rubygem-erubis rubygem-activesupport41 rubygem-minitest rubygem-i18n rubygem-rack15 rubygem-thor rubygem-coffee-script rubygem-coffee-script-source \
rubygem-tinder rubygem-hashie rubygem-multi_json rubygem-json_pure rubygem-faraday_middleware rubygem-faraday rubygem-multipart-post rubygem-mime-types \
rubygem-tilt1 \
rubygem-tilt \
rubygem-temple \
rubygem-stringex \
rubygem-state_machine \
rubygem-stamp \
rubygem-sqlite3 \
rubygem-sprockets3 \
rubygem-sprockets rubygem-hike \
rubygem-spring \
rubygem-slim \
autoconf autoconf-wrapper \
bison \
cmake jsoncpp libarchive lzo2 cmake-modules \
gettext-tools \
gmake \
gmake-lite \
help2man p5-Locale-gettext \
libatomic_ops \
libgit2 libssh2 \
pkgconf \
py27-Babel py27-pytz \
py27-Jinja2 py27-MarkupSafe \
py27-alabaster \
py27-docutils \
py27-pygments \
py27-pystemmer \
py27-snowballstemmer \
py27-sphinx py27-sphinx_rtd_theme \
rubygem-CFPropertyList \
rubygem-ace-rails-ap \
rubygem-actionmailer41 rubygem-mail \
rubygem-activemodel41 \
rubygem-activerecord41 rubygem-arel \
rubygem-addressable \
rubygem-asciidoctor \
rubygem-attr_encrypted rubygem-encryptor \
rubygem-attr_required \
rubygem-autoprefixer-rails \
rubygem-bcrypt \
rubygem-bootstrap-sass rubygem-sass \
rubygem-browser \
rubygem-charlock_holmes \
rubygem-colored \
rubygem-crass \
rubygem-creole \
rubygem-diff-lcs \
rubygem-diffy \
rubygem-escape_utils-rails4 \
rubygem-excon \
rubygem-fission \
rubygem-flowdock rubygem-httparty rubygem-multi_xml \
rubygem-fog rubygem-fog-softlayer rubygem-fog-core rubygem-net-ssh rubygem-ruby-termios rubygem-formatador rubygem-net-scp rubygem-fog-json rubygem-fog-google rubygem-fog-xml rubygem-fog-vmfusion rubygem-fog-radosgw rubygem-fog-local rubygem-fog-dynect rubygem-fog-atmos rubygem-fog-sakuracloud rubygem-fog-brightbox rubygem-inflecto rubygem-fog-powerdns rubygem-fog-storm_on_demand rubygem-ipaddress rubygem-fog-ecloud rubygem-fog-riakcs rubygem-fog-aws rubygem-fog-terremark rubygem-fog-serverlove rubygem-fog-profitbricks rubygem-fog-voxel \
rubygem-foreman \
rubygem-gemnasium-gitlab-service rubygem-rugged \
rubygem-gemojione libedit \
rubygem-github-markup \
rubygem-gitlab-flowdock-git-hook rubygem-gitlab-grit rubygem-mime-types1 rubygem-diff-lcs rubygem-charlock_holmes icu rubygem-posix-spawn rubygem-flowdock rubygem-multi_json rubygem-json_pure rubygem-httparty rubygem-multi_xml \
rubygem-gitlab-grack rubygem-rack15 \
rubygem-gitlab-linguist rubygem-escape_utils-rails4 \
rubygem-gitlab_emoji \
rubygem-gitlab_meta \
rubygem-gitlab_omniauth-ldap rubygem-rubyntlm rubygem-pyu-ruby-sasl rubygem-omniauth rubygem-hashie rubygem-rack16 rubygem-net-ldap \
rubygem-gollum-grit_adapter \
rubygem-gollum-lib rubygem-sanitize libxml2 rubygem-crass rubygem-nokogiri libxslt libgcrypt libgpg-error rubygem-nokogumbo rubygem-stringex rubygem-rouge \
rubygem-haml rubygem-tilt \
rubygem-hipchat rubygem-mimemagic \
rubygem-html2haml rubygem-erubis rubygem-ruby_parser rubygem-sexp_processor \
rubygem-httpclient \
rubygem-ice_cube \
rubygem-jbuilder-rails41 rubygem-activesupport41 rubygem-minitest rubygem-i18n rubygem-thread_safe1 rubygem-atomic rubygem-tzinfo \
rubygem-jquery-atwho-rails-rails4 \
rubygem-jwt \
rubygem-mousetrap-rails \
rubygem-newrelic_rpm \
rubygem-nprogress-rails \
rubygem-oauth \
rubygem-oauth2 rubygem-faraday rubygem-multipart-post \
rubygem-octokit rubygem-sawyer rubygem-addressable \
rubygem-omniauth-bitbucket rubygem-omniauth-oauth \
rubygem-omniauth-github rubygem-omniauth-oauth2 \
rubygem-omniauth-gitlab \
rubygem-omniauth-google-oauth2 \
rubygem-omniauth-saml rubygem-ruby-saml rubygem-uuid rubygem-macaddr rubygem-systemu \
rubygem-omniauth-shibboleth \
rubygem-omniauth-twitter \
rubygem-org-ruby rubygem-rubypants \
rubygem-orm_adapter \
rubygem-pg postgresql93-client \
rubygem-rack-accept \
rubygem-rack-attack \
rubygem-rack-cors \
rubygem-rack-mount \
rubygem-rack-protection \
rubygem-rake \
rubygem-raphael-rails \
rubygem-rdoc \
rubygem-redcarpet \
rubygem-redcloth \
rubygem-redis \
rubygem-redis-namespace \
rubygem-redis-rack rubygem-redis-store \
rubygem-request_store \
rubygem-rinku \
rubygem-rotp \
rubygem-rqrcode \
rubygem-rqrcode-rails3 \
rubygem-sass32 \
rubygem-sdoc \
rubygem-select2-rails rubygem-thor \
rubygem-settingslogic \
rubygem-sidekiq rubygem-celluloid rubygem-celluloid-pool rubygem-nenv rubygem-dotenv rubygem-rspec-logsplit rubygem-celluloid-extras rubygem-celluloid-essentials rubygem-celluloid-fsm rubygem-celluloid-supervision rubygem-connection_pool rubygem-timers rubygem-hitimes rubygem-bundler \
rubygem-sidetiq \
rubygem-sinatra \
rubygem-six \
rubygem-slack-notifier



cd /usr/ports/www/gitlab/
# make config-recursive
make && make install && make package-recursive && make clean
# see /var/ports/packages/All/
